(in-package #:structy-defclass)

;; (deftclass name
;;   a
;;   (b 0)
;;   (c 0 :type fixnum))

(defmacro deftclass (name &body slots)
  (labels ((symb (&rest args)
             (intern (format nil "狺狎珞┅膑é蝈篝狎珞ㄩ铘弪ㄦ矧磲铋狺狎珞ㄦ轭洵疳汶徵⑺刨紫夷┅镳糸镱鲠扉铹ㄡ钿扉篝铹戾铉翳铹脲黠蜾ㄦ轵篝铹矧簌礅镬箦泔钿铹ㄡ钿扉篝箦泔钿铹ㄥ鲥蝙＇簌礅镬箦泔钿铹┅铒脲黠蜾箦泔钿铹┅┅镳糸镱蟓鲠扉镳糸镱螬ㄥ鲥蝙＇镳糸镱鲠扉镳糸镱螬痱镢弩蟓狎珞ㄡ蜱螬戾è钺礤ㄦ轵篝狎珞┅镳糸镱蝈篝狎珞┅ㄩ镳糸镱蟓鲠扉镳糸镱螬ㄣ镱钺礤ㄡ痧禊＇狃疱钿镳糸镱螬ㄥ蝌矧ヤ彐翥灬篌镳糸镱磲戽矧礤浜幄ㄣ镱т彐翥灬篌狎珞┅┅┅ㄤ弩趄蹉趱蜷铉忾钿钺礤脲轭沆蹁泔铙趄蹉麸ㄣ镱悱钺礤铋泔钽洎痱镢弩蟓狎珞ㄩ扉篝钺礤钺礤扉篝钺礤┅戾舄è箪雉磲疸狎灬礅溽螬ㄩ扉篝螬扉篝螬┅箪雉螬ㄩ钽祯溴ㄩ扉篝轭沆蹁濠轭沆蹁扉篝轭沆蹁濠┅ㄣ镱篝蝓泗矧矧泔铙趄蹉麸簌礅喉犭瀛钺礤┅痱邃殂狒簌礅钺礤涵皓ㄣ镱悱钺礤矧泔钽钺礤躅戾篌泔钽膑钺礤涵┅┅箪雉钺礤磲疸狎＇骈蝮箪雉螬箪雉箦麴磲疸狎灬礅溽ㄧ孱簌簌礅镬钺礤┅箪雉钺礤螬ㄣ镱悱狎珞磲疸狎灬礅溽啜铋┅箪雉钺礤箪雉箦麴┅ㄤ彐狨祠磲疸狎＇箦泔钿箪雉螬ㄣ镱悱脲磲疸犷灬礅溽啜膑ㄩ┅箪雉钺礤箪雉箦麴溴驷蹯趔┅灬忮祗è痱镢弩蟓箪雉箪雉ㄤ弩趄蹉趱蜷铉忾钿钺礤蝈篝箪雉ㄤ弩趄蹉趱蜷铉忾钿鲠脲豉疱舂蝈徜镱禊铋飑矧蝈篝Ж铋飑ㄤ邈灬蝈ㄩ珙矧豉疱蝈徜镱禊┅啜钺礤洪铋翎蜱膑钺礤洪铋翩矧鲠呼疱豉疱┅┅痱镢弩蟓徙箪雉ㄤ弩趄蹉趱蜷铉忾钿钺礤蝈篝箪雉ㄤ弩趄蹉趱蜷铉忾钿鲠脲豉疱舂蝈徜镱禊铋飑矧蝈篝Ж铋飑ㄤ邈灬蝈ㄩ珙矧鲠飑戾è犷犴ㄣ镱ㄣ镱悱钺礤簌礅泔钽钺礤钺礤┅钺礤┅┅啜ㄤ彐躅犷犴镡戛翳豉疱箪雉鲠祯镡К钺礤┅括躅戾篌蝈徜镱禊啜ㄤ彐躅箦翩犷犴濠鲠镡戛箦翩箪雉鲠祯镡К钺礤鲠飑┅┅┅┅啜痱镧ㄤ彐沆狍钺礤轭沆蹁磲疸狎＇痱镢弩蟓箪雉箪雉螬括殒轭沆蹁啜ㄤ彐躅泔铙趄蹉麸é蝈篝狎珞脲荔祜舡钺礤犰祜鳝雉桢颦脲螬ㄤ邈灬蝈ㄩ珙矧荔祜舡钺礤螬ㄡ痧禊＇磲脲轭篝犷沐ㄣ镱К钺礤狎珞┅┅啜ㄤ彐躅泔铙趄蹉麸é脲楞镱悱狎珞磲脲轭篝犷沐К钺礤楞镱悱脲螬┅ㄤ彐躅痱邃殂狒豉疱К钺礤┅括蝈漉沐＇狃疱钿磲疸狎＇痱镢弩蟓徙箪雉螬К钺礤┅┅┅